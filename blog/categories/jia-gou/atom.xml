<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 架构 | 聂同学]]></title>
  <link href="http://www.nietongxue.xyz/blog/categories/jia-gou/atom.xml" rel="self"/>
  <link href="http://www.nietongxue.xyz/"/>
  <updated>2016-04-03T18:34:14+08:00</updated>
  <id>http://www.nietongxue.xyz/</id>
  <author>
    <name><![CDATA[nielinjie]]></name>
    <email><![CDATA[nielinjie@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[重构，从知识结构开始（二）]]></title>
    <link href="http://www.nietongxue.xyz/blog/2016/04/02/dev-dc2/"/>
    <updated>2016-04-02T15:30:25+08:00</updated>
    <id>http://www.nietongxue.xyz/blog/2016/04/02/dev-dc2</id>
    <content type="html"><![CDATA[<p>我们认为两个方面的措施可以改善我们的知识结构。</p>

<!--more-->


<h3>一、设计和维护知识结构</h3>

<p>知识结构必须有意识地设计和维护。</p>

<p>我们使用上下文（Context）和上下文地图（Context Map）来结构化我们的知识，这两个概念都来自于DDD战略设计<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>。
简单讲上下文就是知识一致性的单元。上下文地图就是上下文之间的关系。</p>

<p>上下文如下图示意，是一个有明确边界的单元，知识是其核心，也是其价值。边界中的其他元素是维持知识的手段。左边的是知识的描述，比如模型。右上是知识的守护和传承者：团队。右下是知识的体现形式——各种组件，比如后台的服务，前台的Android App，数据库Schema等。</p>

<p>而上下文地图，是描述和维护上下文之间的关系的一个图。上下文与上下文地图加在一起，体现了全局范围内对知识结构的设计。</p>

<p><img src="/images/domain/context.png" width="400"></p>

<h3>二、区别应用知识与领域知识</h3>

<p>应用知识描述的是如何（使用业务来）达成功能，领域知识描述的是业务本身。明确这两种知识的差别，除了一般的划分知识制造隔离的目的外，主要的是两个目的：</p>

<ol>
<li>解决前文提到的“补丁”和“碎片”问题。应用和领域分开演化，解决“补丁”问题；领域负责业务维护业务一致性，解决“碎片”问题。</li>
<li>建立明确稳定的知识关联。如果没有领域，应用之间直接关联，在不同的时段不停变化，今天由于这项业务跟这个应用关联，明天又由于那项业务跟那个应用关联。关联不稳定，如下图左方所示。而有了领域作为关联枢纽，应用之间不需要直接关联，同时应用与领域的关联不会经常变化。</li>
</ol>


<p><img src="/images/domain/ad.png" width="400"></p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Eric Evans《领域驱动设计——软件核心复杂性应对之道》<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[架构是一种管理手段]]></title>
    <link href="http://www.nietongxue.xyz/blog/2016/03/19/am/"/>
    <updated>2016-03-19T09:59:18+08:00</updated>
    <id>http://www.nietongxue.xyz/blog/2016/03/19/am</id>
    <content type="html"><![CDATA[<p>是的。如果不是最重要的那一种的话。</p>

<!--more-->


<p>架构同时也是管理的目的。既是目的又是手段。有点像是修金字塔，基础部分的修建既是目的又是手段。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[重构，从知识结构开始（一）]]></title>
    <link href="http://www.nietongxue.xyz/blog/2016/02/20/dev-dc/"/>
    <updated>2016-02-20T14:17:28+08:00</updated>
    <id>http://www.nietongxue.xyz/blog/2016/02/20/dev-dc</id>
    <content type="html"><![CDATA[<p>我们意识到系统中存在的大量结构性问题，根源都是我们知识的结构问题。
在知识结构层面，我们有两个主要问题。</p>

<!--more-->


<h3>一、没有意识到知识需要拆分</h3>

<p>大家有个印象，认为对业务知识掌握越全面越好。没有意识到这里面其实有个陷阱。业务知识越全面越好，其实指的是“了解”得越全面越好，而不是“掌握”得越全面越好。<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p>

<p>所以大家没有想到需要对知识进行有意识地拆分。也就是说没有想到：</p>

<p><strong>知识需要结构。而且这个结构需要设计。</strong></p>

<p>我们来看看我们需要什么样的知识结构。</p>

<p>首先，我们的知识结构要能降低负担，使人集中精力。每个人掌握的知识刚好可以完成手边的工作。而不需要掌握所有的知识，就像造车轮胎的工程师不需要关心车身油漆的工艺，更不需要关心油漆工业发展趋势。</p>

<p>其次，我们的知识结构要能制造适当的隔离。这样我们能解开知识间的耦合，有助于解决知识在全局的概念不一致，也有助于协调知识演进的步调。</p>

<p>第三，我们的知识结构要能减少关联风险。知识不可能不与其他知识关联，那么我们希望关联越明确越稳定越好。如果关联不停产生不停终结不停变化，那么谁也没办法保证每次都能正确完整地识别。</p>

<h3>二、知识的结构来自于“产品线”</h3>

<p>虽然大家并没有意识到需要关注知识结构。但知识结构其实已经自然存在了。我们团队的结构和需求驱动的研发过程决定了我们的知识结构直接来自于我们的“产品线”结构。<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></p>

<p>以“产品线”分布的知识有显著的特点：</p>

<ul>
<li>“补丁”： 补丁指的是一个产品线涉及到的业务知识方面很多，而且在无法控制地不断堆积。只要功能集发生变化，更多业务知识就要堆积上来。</li>
<li>“碎片”： 碎片是指一个方面的业务知识分散在不同的产品线上，这些业务知识的一致性很难保证。要想维护一套完整的业务规则，往往需要在各个产品线穿梭，不时进行跨产品线归纳。</li>
</ul>


<p>这时候的情况类似于下图中Transaction Script的情况。</p>

<p>显然，来自于“产品线”的知识结构，不能满足我们上面谈到的对知识结构的要求。</p>

<p><img src="/images/domain/domain.gif" width="400"></p>

<p>（<a href="/blog/2016/04/02/dev-dc2/">后文继续，讲讲我们的解决思路</a>）</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>所谓“掌握”，指的是可以直接指导研发，并使其产生业务价值的程度。而“了解”，指的是明了其大致原理的程度。举个时髦的例子，你能明白《时间简史》，大概可以算是了解相对论。但你能设计探测引力波的方案，才能算掌握相对论。<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>我们这里的“产品线”可能跟很多团队的“产品线”概念不一样。我们的产品线大部分其实是同一套业务的不同功能集。比如有面向不同用户角色的不同功能集，体现在不同客户端的不同功能集等等。<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[领域对象的没落？]]></title>
    <link href="http://www.nietongxue.xyz/blog/2016/01/19/do-die/"/>
    <updated>2016-01-19T09:21:19+08:00</updated>
    <id>http://www.nietongxue.xyz/blog/2016/01/19/do-die</id>
    <content type="html"><![CDATA[<p>最近，网红架构师学镛老师提出了观点，说用对象模型来体现领域已不太适用于现代系统环境，比如分布式和高并发。<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p>

<!--more-->


<p>我是同意这个观点的。</p>

<p>我认为究其原因，主要是因为目前的服务<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>提供方式。不是以对象为单位包装为服务。由于性能、容错、可伸缩、可扩展等质量要求，人们常使用分布式和松耦合的接口，比如REST风格的HTTP接口、Reactive风格的消息接口。而曾经流行的对象风格的接口，比如EJB，由于不适应这些现代质量要求，已经逐渐淡出了视线。</p>

<p>如果服务不以对象的方式提供，则领域对象无法直接映射为服务。那么领域对象的意义就局限到服务内部。而在更重要的、有全局意义的服务设计和跨服务过程设计中，就不再有使用领域对象的理由。</p>

<p>体现在实践中，领域过程仍然是最重要的知识，只是现在更多的领域过程被分解为子过程的调用和信息的流动，而不是对象和对象间的协作。</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>原话在<a href="http://weibo.com/rebol">这里</a>。<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>这里通篇使用的是“服务”这个词语，但指的是广义的可重用组件。<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在发展中团队：微服务？]]></title>
    <link href="http://www.nietongxue.xyz/blog/2016/01/05/dev-micro/"/>
    <updated>2016-01-05T10:08:59+08:00</updated>
    <id>http://www.nietongxue.xyz/blog/2016/01/05/dev-micro</id>
    <content type="html"><![CDATA[<p>当系统成长的时候，大家都想到“微服务”。</p>

<!--more-->


<p>微服务太火，好像成了理所当然。但应该考虑微服务是否适于这个团队。</p>

<p>对于微服务本身，正反两方驱动力讲得比较多了<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>。</p>

<p>而微服务落实到团队，需要考虑更多：文化需要推广？团队需要重组？技能需要学习？过程可能调整？平台需要验证？……</p>

<p>对照团队现状和发展步调，我们必须知道能得到什么，又需要付出什么。</p>

<p>想要提高可用性？可能只需要多份部署。</p>

<p>想要改善逻辑结构？可能只需要开发时模块化。</p>

<p>想要错误隔离？可能只需要分布式。</p>

<p>想要解耦和可重用化？可能只需要服务化。</p>

<p>……</p>

<p>微服务是一套工具，而不是一件。团队可以做出裁剪，也可以做出渐进策略。</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p><a href="/blog/2015/12/01/micro/">微服务的“微”</a><a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
</feed>
